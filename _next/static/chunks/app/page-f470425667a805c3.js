(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{247:(e,s,t)=>{Promise.resolve().then(t.bind(t,7102))},7102:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>z});var a=t(5155),r=t(2115),l=t(7273),i=t(4521),n=t(6041),d=t(2821),c=t(5889);function m(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,c.QP)((0,d.$)(s))}function o(e){return e.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"})}function x(e){return e.toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit"})}function u(e){if(e<60)return"".concat(e,"分钟");let s=Math.floor(e/60),t=e%60;return 0===t?"".concat(s,"小时"):"".concat(s,"小时").concat(t,"分钟")}function h(e){let{task:s,assignedUser:t,onEdit:r,onDelete:l}=e,{attributes:d,listeners:c,setNodeRef:x,transform:h,isDragging:g}=(0,i.PM)({id:s.id}),b=h?{transform:"translate3d(".concat(h.x,"px, ").concat(h.y,"px, 0)")}:void 0;return(0,a.jsxs)("div",{ref:x,style:b,...c,...d,className:m("p-3 sm:p-4 rounded-lg border-2 cursor-grab active:cursor-grabbing transition-all duration-200 task-card draggable-item","touch-action-none select-none",(e=>{switch(e){case n.e.TODO:return"border-gray-200 bg-white";case n.e.IN_PROGRESS:return"border-blue-200 bg-blue-50";case n.e.COMPLETED:return"border-green-200 bg-green-50";default:return"border-gray-200 bg-white"}})(s.status),g&&"opacity-50 scale-105 shadow-lg",s.isUrgent&&"ring-2 ring-red-400"),children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1 sm:gap-2 min-w-0 flex-1",children:[(0,a.jsx)("span",{className:"text-base sm:text-lg flex-shrink-0",children:(e=>{switch(e){case n.e.TODO:return"⏳";case n.e.IN_PROGRESS:return"\uD83D\uDD04";case n.e.COMPLETED:return"✅";default:return"⏳"}})(s.status)}),(0,a.jsx)("h3",{className:"font-medium text-gray-900 text-sm sm:text-base truncate",children:s.title})]}),s.isUrgent&&(0,a.jsx)("span",{className:"px-2 py-1 text-xs bg-red-100 text-red-700 rounded-full flex-shrink-0 ml-2",children:"加急"})]}),s.description&&(0,a.jsx)("p",{className:"text-xs text-gray-600 mb-3 line-clamp-2",children:s.description}),(0,a.jsxs)("div",{className:"space-y-2",children:[t&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"分配给:"}),(0,a.jsx)("span",{className:"text-xs font-medium text-gray-700",children:t.name})]}),s.estimatedMinutes&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"预估:"}),(0,a.jsx)("span",{className:"text-xs text-gray-700",children:u(s.estimatedMinutes)})]}),s.status===n.e.COMPLETED&&s.actualMinutes&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"实际:"}),(0,a.jsx)("span",{className:"text-xs text-green-700 font-medium",children:u(s.actualMinutes)})]}),s.startedAt&&s.status===n.e.IN_PROGRESS&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"开始:"}),(0,a.jsx)("span",{className:"text-xs text-blue-700",children:o(new Date(s.startedAt))})]}),s.completedAt&&s.status===n.e.COMPLETED&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"完成:"}),(0,a.jsx)("span",{className:"text-xs text-green-700",children:o(new Date(s.completedAt))})]}),s.isUrgent&&s.urgentPrice&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"外包价:"}),(0,a.jsxs)("span",{className:"text-xs text-red-700 font-medium",children:["\xa5",s.urgentPrice]})]})]}),(0,a.jsxs)("div",{className:"mt-3 flex items-center justify-between",children:[(0,a.jsx)("span",{className:"px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded",children:s.category}),(0,a.jsx)("span",{className:"text-xs text-gray-400",children:function(e){let s=Math.floor((new Date().getTime()-e.getTime())/6e4);if(s<1)return"刚刚";if(s<60)return"".concat(s,"分钟前");if(s<1440){let e=Math.floor(s/60);return"".concat(e,"小时前")}{let e=Math.floor(s/1440);return"".concat(e,"天前")}}(new Date(s.createdAt))})]}),!g&&(r||l)&&(0,a.jsxs)("div",{className:"mt-3 flex gap-3 sm:gap-2",children:[r&&(0,a.jsx)("button",{onClick:e=>{e.stopPropagation(),r(s)},className:"text-xs sm:text-sm text-blue-600 hover:text-blue-800 btn-touch min-h-[32px] px-2",children:"编辑"}),l&&(0,a.jsx)("button",{onClick:e=>{e.stopPropagation(),l(s.id)},className:"text-xs sm:text-sm text-red-600 hover:text-red-800 btn-touch min-h-[32px] px-2",children:"删除"})]})]})}function g(e){let{id:s,title:t,status:r,tasks:l,users:d,onEditTask:c,onDeleteTask:o}=e,{isOver:x,setNodeRef:u}=(0,i.zM)({id:s}),g=e=>{switch(e){case n.e.TODO:return"bg-gray-50 border-gray-200";case n.e.IN_PROGRESS:return"bg-blue-50 border-blue-200";case n.e.COMPLETED:return"bg-green-50 border-green-200";default:return"bg-gray-50 border-gray-200"}},b=l.filter(e=>e.status===r);return(0,a.jsx)("div",{className:"flex-1 min-w-0",children:(0,a.jsxs)("div",{className:m("bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden","sm:bg-transparent sm:rounded-none sm:shadow-none sm:border-none sm:overflow-visible"),children:[(0,a.jsx)("div",{className:m("p-3 sm:p-4","sm:rounded-t-lg sm:border-2 sm:border-b-0","sm:"+g(r)),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1 sm:gap-2",children:[(0,a.jsx)("span",{className:"text-base sm:text-lg",children:(e=>{switch(e){case n.e.TODO:return"\uD83D\uDCCB";case n.e.IN_PROGRESS:return"\uD83D\uDD04";case n.e.COMPLETED:return"✅";default:return"\uD83D\uDCCB"}})(r)}),(0,a.jsx)("h2",{className:"font-semibold text-gray-900 text-sm sm:text-base",children:t})]}),(0,a.jsx)("span",{className:"px-2 py-1 text-xs bg-white rounded-full text-gray-600 font-medium",children:b.length})]})}),(0,a.jsxs)("div",{ref:u,className:m("min-h-[200px] sm:min-h-[400px] p-3 sm:p-4 transition-colors task-board-column","bg-gray-50","sm:border-2 sm:border-t-0 sm:rounded-b-lg sm:bg-transparent","sm:"+g(r),x&&"ring-2 ring-blue-400 ring-opacity-50"),children:[(0,a.jsx)("div",{className:"space-y-2 sm:space-y-3",children:0===b.length?(0,a.jsx)("div",{className:"flex items-center justify-center h-24 sm:h-32 text-gray-400",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("div",{className:"text-xl sm:text-2xl mb-1 sm:mb-2",children:[r===n.e.TODO&&"\uD83C\uDFAF",r===n.e.IN_PROGRESS&&"\uD83D\uDCAA",r===n.e.COMPLETED&&"\uD83C\uDF89"]}),(0,a.jsxs)("p",{className:"text-xs sm:text-sm",children:[r===n.e.TODO&&"暂无待办任务",r===n.e.IN_PROGRESS&&"暂无进行中任务",r===n.e.COMPLETED&&"暂无已完成任务"]})]})}):b.map(e=>{let s=d.find(s=>s.id===e.assignedTo);return(0,a.jsx)(h,{task:e,assignedUser:s,onEdit:c,onDelete:o},e.id)})}),x&&(0,a.jsx)("div",{className:"mt-3 sm:mt-4 p-3 sm:p-4 border-2 border-dashed border-blue-400 rounded-lg bg-blue-50",children:(0,a.jsxs)("p",{className:"text-center text-blue-600 text-xs sm:text-sm",children:['松开以移动任务到 "',t,'"']})})]})]})})}var b=t(6274);function p(e){let{tasks:s,family:t}=e,{actions:d}=(0,l.n)(),[c,m]=(0,r.useState)(null),o=(0,i.FR)((0,i.MS)(i.AN,{activationConstraint:{distance:8,delay:100,tolerance:5}})),x=e=>{console.log("Edit task:",e)},u=e=>{confirm("确定要删除这个任务吗？")&&d.deleteTask(e)},p=[{id:n.e.TODO,title:"待做",status:n.e.TODO},{id:n.e.IN_PROGRESS,title:"进行中",status:n.e.IN_PROGRESS},{id:n.e.COMPLETED,title:"已完成",status:n.e.COMPLETED}];return(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsxs)("div",{className:"mb-4 sm:mb-6 grid grid-cols-3 gap-2 sm:gap-4",children:[(0,a.jsx)("div",{className:"bg-white p-3 sm:p-4 rounded-lg border shadow-sm",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-lg sm:text-2xl font-bold text-gray-900",children:s.filter(e=>e.status===n.e.TODO).length}),(0,a.jsx)("div",{className:"text-xs sm:text-sm text-gray-500",children:"待办任务"})]})}),(0,a.jsx)("div",{className:"bg-white p-3 sm:p-4 rounded-lg border shadow-sm",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-lg sm:text-2xl font-bold text-blue-600",children:s.filter(e=>e.status===n.e.IN_PROGRESS).length}),(0,a.jsx)("div",{className:"text-xs sm:text-sm text-gray-500",children:"进行中"})]})}),(0,a.jsx)("div",{className:"bg-white p-3 sm:p-4 rounded-lg border shadow-sm",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-lg sm:text-2xl font-bold text-green-600",children:s.filter(e=>e.status===n.e.COMPLETED).length}),(0,a.jsx)("div",{className:"text-xs sm:text-sm text-gray-500",children:"已完成"})]})})]}),(0,a.jsxs)(i.Mp,{sensors:o,onDragStart:e=>{let{active:t}=e;m(s.find(e=>e.id===t.id)||null)},onDragEnd:e=>{let{active:a,over:r}=e;if(m(null),!r)return;let l=a.id,i=r.id,c=s.find(e=>e.id===l);if(c&&c.status!==i){if((0,b.I1)(t.workEndTime)&&c.status===n.e.TODO&&i===n.e.IN_PROGRESS)return void alert("收工时间已到！如需继续工作，请使用加急功能。");d.moveTask(l,i)}},children:[(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 sm:gap-6",children:p.map(e=>(0,a.jsx)(g,{id:e.id,title:e.title,status:e.status,tasks:s,users:t.members,onEditTask:x,onDeleteTask:u},e.id))}),(0,a.jsx)(i.Hd,{children:c?(0,a.jsx)("div",{className:"rotate-3 scale-105",children:(0,a.jsx)(h,{task:c,assignedUser:t.members.find(e=>e.id===c.assignedTo)})}):null})]}),(0,b.I1)(t.workEndTime)&&(0,a.jsx)("div",{className:"mt-6 p-4 bg-orange-50 border border-orange-200 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-orange-500",children:"⏰"}),(0,a.jsxs)("p",{className:"text-orange-700 text-sm",children:["收工时间已到（",t.workEndTime,"）！新增任务需要议价确认。"]})]})})]})}function j(e){let{variant:s="primary",size:t="md",className:r,children:l,...i}=e;return(0,a.jsx)("button",{className:m("inline-flex items-center justify-center rounded-lg font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none",{primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",secondary:"bg-gray-600 text-white hover:bg-gray-700 focus:ring-gray-500",outline:"border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 focus:ring-blue-500",ghost:"text-gray-700 hover:bg-gray-100 focus:ring-gray-500",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500"}[s],{sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"}[t],r),...i,children:l})}function f(e){let{family:s,onShowStats:t,onShowTaskCreator:r,onShowTaskGrab:l}=e,i=o(new Date);return(0,a.jsx)("header",{className:"bg-white shadow-sm border-b",children:(0,a.jsxs)("div",{className:"container mx-auto px-4 py-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"flex items-center gap-4",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:s.name}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["当前时间 ",i]})]})}),(0,a.jsxs)("div",{className:"hidden md:flex items-center gap-6",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("div",{className:"text-2xl font-bold text-blue-600",children:[0,"/",0]}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:"今日任务"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:["\xa5",s.monthlyFund]}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:"月度基金"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1 sm:gap-3",children:[(0,a.jsxs)(j,{variant:"outline",size:"sm",className:"btn-touch min-w-[44px] min-h-[44px] px-2 sm:px-3",title:"收工时间：".concat(s.workEndTime),children:[(0,a.jsx)("span",{className:"text-xl sm:text-lg",children:"\uD83D\uDD14"}),(0,a.jsx)("span",{className:"hidden sm:inline ml-1 text-sm",children:"收工铃"})]}),l&&(0,a.jsxs)(j,{variant:"outline",size:"sm",onClick:l,className:"btn-touch min-w-[44px] min-h-[44px] px-2 sm:px-3",children:[(0,a.jsx)("span",{className:"text-xl sm:text-lg",children:"\uD83D\uDCAA"}),(0,a.jsx)("span",{className:"hidden sm:inline ml-1 text-sm",children:"抢单"})]}),(0,a.jsxs)(j,{variant:"outline",size:"sm",onClick:t,className:"btn-touch min-w-[44px] min-h-[44px] px-2 sm:px-3",children:[(0,a.jsx)("span",{className:"text-xl sm:text-lg",children:"\uD83D\uDCCA"}),(0,a.jsx)("span",{className:"hidden sm:inline ml-1 text-sm",children:"战绩"})]}),(0,a.jsxs)(j,{variant:"primary",size:"sm",onClick:r,className:"btn-touch min-w-[44px] min-h-[44px] px-2 sm:px-3",children:[(0,a.jsx)("span",{className:"text-xl sm:text-lg",children:"➕"}),(0,a.jsx)("span",{className:"hidden sm:inline ml-1 text-sm",children:"添加任务"})]})]})]}),(0,a.jsx)("div",{className:"mt-3 sm:mt-4",children:(0,a.jsx)("div",{className:"bg-gradient-to-r from-blue-50 to-green-50 rounded-lg p-3 sm:p-4 border border-blue-100",children:(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-3 text-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-lg sm:text-xl font-bold text-blue-600",children:[0,"/",0]}),(0,a.jsx)("div",{className:"text-xs text-gray-600",children:"今日任务"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-lg sm:text-xl font-bold text-green-600",children:["\xa5",s.monthlyFund]}),(0,a.jsx)("div",{className:"text-xs text-gray-600",children:"月度基金"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-lg sm:text-xl font-bold text-orange-600",children:s.workEndTime}),(0,a.jsx)("div",{className:"text-xs text-gray-600",children:"收工时间"})]})]})})}),(0,a.jsxs)("div",{className:"mt-3 sm:mt-4 flex items-center gap-2 sm:gap-4",children:[(0,a.jsx)("span",{className:"text-xs sm:text-sm text-gray-500 flex-shrink-0",children:"成员："}),(0,a.jsx)("div",{className:"flex gap-1 sm:gap-2 overflow-x-auto scrollbar-hide",children:s.members.map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-1 sm:gap-2 px-2 sm:px-3 py-1 bg-gray-100 rounded-full flex-shrink-0",children:[(0,a.jsx)("div",{className:"w-5 h-5 sm:w-6 sm:h-6 bg-blue-500 rounded-full flex items-center justify-center text-white text-xs font-medium",children:e.name.charAt(0)}),(0,a.jsx)("span",{className:"text-xs sm:text-sm text-gray-700 whitespace-nowrap",children:e.name}),(0,a.jsxs)("span",{className:"text-xs text-gray-500",children:[e.totalCompletedTasks,"项"]})]},e.id))})]})]})})}function v(e){let{workEndTime:s,onClose:t,onContinue:l}=e,[i,n]=(0,r.useState)(new Date),[d,c]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{let e=setInterval(()=>{n(new Date)},1e3),s=setTimeout(()=>{c(!1)},2e3);return()=>{clearInterval(e),clearTimeout(s)}},[]),(0,r.useEffect)(()=>{try{let e=new(window.AudioContext||window.webkitAudioContext),s=e.createOscillator(),t=e.createGain();s.connect(t),t.connect(e.destination),s.frequency.setValueAtTime(800,e.currentTime),s.frequency.setValueAtTime(600,e.currentTime+.1),s.frequency.setValueAtTime(800,e.currentTime+.2),t.gain.setValueAtTime(.3,e.currentTime),t.gain.exponentialRampToValueAtTime(.01,e.currentTime+.3),s.start(e.currentTime),s.stop(e.currentTime+.3)}catch(e){console.log("无法播放铃声:",e)}},[]),(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg max-w-md w-full p-6 relative overflow-hidden",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-orange-50 to-yellow-50 opacity-50"}),(0,a.jsxs)("div",{className:"relative text-center",children:[(0,a.jsx)("div",{className:"text-6xl mb-4 transition-transform duration-300 ".concat(d?"animate-bounce":""),children:"\uD83D\uDD14"}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Time is up!"}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("p",{className:"text-gray-600 mb-2",children:["收工时间到了！（",s,"）"]}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["当前时间：",o(i)]})]}),(0,a.jsxs)("div",{className:"mb-6 p-4 bg-orange-50 border border-orange-200 rounded-lg text-left",children:[(0,a.jsx)("h3",{className:"font-medium text-orange-800 mb-2",children:"收工规则："}),(0,a.jsxs)("ul",{className:"text-sm text-orange-700 space-y-1",children:[(0,a.jsx)("li",{children:"• 新增任务默认延期到明天"}),(0,a.jsx)("li",{children:"• 继续工作需要议价确认"}),(0,a.jsx)("li",{children:"• 议价金额将加入月度基金"})]})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsxs)(j,{variant:"outline",onClick:t,className:"flex-1",children:[(0,a.jsx)("span",{className:"mr-2",children:"\uD83D\uDE34"}),"直接收工"]}),(0,a.jsxs)(j,{variant:"primary",onClick:l,className:"flex-1",children:[(0,a.jsx)("span",{className:"mr-2",children:"\uD83D\uDCAA"}),"仍要加急"]})]}),(0,a.jsx)("p",{className:"text-xs text-gray-400 mt-4",children:"\uD83D\uDCA1 适当休息有助于提高工作效率"})]})]})})}let N=[{id:"template-1",title:"扫地拖地",description:"清扫客厅、卧室、厨房地面并拖地",estimatedMinutes:25,category:"清洁",icon:"\uD83E\uDDF9"},{id:"template-2",title:"洗碗刷锅",description:"清洗餐具、锅具并整理厨房台面",estimatedMinutes:15,category:"厨房",icon:"\uD83C\uDF7D️"},{id:"template-3",title:"丢垃圾",description:"清理各房间垃圾桶并倒垃圾",estimatedMinutes:10,category:"清洁",icon:"\uD83D\uDDD1️"},{id:"template-4",title:"叠衣服",description:"整理晾干的衣物并放入衣柜",estimatedMinutes:20,category:"整理",icon:"\uD83D\uDC55"},{id:"template-5",title:"洗衣服",description:"分类脏衣物并启动洗衣机",estimatedMinutes:10,category:"洗涤",icon:"\uD83D\uDC54"},{id:"template-6",title:"晾衣服",description:"将洗好的衣物晾晒或烘干",estimatedMinutes:15,category:"洗涤",icon:"\uD83E\uDDFA"},{id:"template-7",title:"整理床铺",description:"整理卧室床铺和枕头",estimatedMinutes:5,category:"整理",icon:"\uD83D\uDECF️"},{id:"template-8",title:"擦桌子",description:"清洁餐桌、茶几、书桌表面",estimatedMinutes:10,category:"清洁",icon:"\uD83E\uDE91"},{id:"template-9",title:"买菜购物",description:"采购日常生活用品和食材",estimatedMinutes:45,category:"采购",icon:"\uD83D\uDED2"},{id:"template-10",title:"做饭",description:"准备和烹饪一餐",estimatedMinutes:40,category:"厨房",icon:"\uD83C\uDF73"},{id:"template-11",title:"清洁卫生间",description:"清洁马桶、洗手台、浴室",estimatedMinutes:20,category:"清洁",icon:"\uD83D\uDEBF"},{id:"template-12",title:"整理客厅",description:"收拾客厅物品，整理沙发和茶几",estimatedMinutes:15,category:"整理",icon:"\uD83D\uDECB️"}];function y(e){let{family:s,onClose:t}=e,{actions:i}=(0,l.n)(),[d,c]=(0,r.useState)("templates"),[m,o]=(0,r.useState)([]),[x,u]=(0,r.useState)({title:"",description:"",estimatedMinutes:15,category:"其他"}),[h,g]=(0,r.useState)(!1),[p,f]=(0,r.useState)(0),v=(0,b.I1)(s.workEndTime),y=[...new Set(N.map(e=>e.category))];return(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-hidden",children:[(0,a.jsxs)("div",{className:"p-6 border-b",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"创建新任务"}),(0,a.jsx)("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)("span",{className:"text-2xl",children:"\xd7"})})]}),v&&(0,a.jsx)("div",{className:"mt-4 p-3 bg-orange-50 border border-orange-200 rounded-lg",children:(0,a.jsx)("p",{className:"text-orange-700 text-sm",children:"⏰ 收工时间已到！新增任务需要设置为加急并议价。"})})]}),(0,a.jsx)("div",{className:"border-b",children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("button",{onClick:()=>c("templates"),className:"px-6 py-3 text-sm font-medium border-b-2 ".concat("templates"===d?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"),children:"预设模板"}),(0,a.jsx)("button",{onClick:()=>c("custom"),className:"px-6 py-3 text-sm font-medium border-b-2 ".concat("custom"===d?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"),children:"自定义任务"})]})}),(0,a.jsxs)("div",{className:"p-6 max-h-[60vh] overflow-y-auto",children:["templates"===d?(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"选择预设任务模板（可多选）："}),y.map(e=>(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900 mb-3",children:e}),(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:N.filter(s=>s.category===e).map(e=>(0,a.jsx)("div",{onClick:()=>{var s;return s=e.id,void o(e=>e.includes(s)?e.filter(e=>e!==s):[...e,s])},className:"p-4 border-2 rounded-lg cursor-pointer transition-all ".concat(m.includes(e.id)?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("span",{className:"text-2xl",children:e.icon}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:e.title}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.description}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-2",children:["预估 ",e.estimatedMinutes," 分钟"]})]}),m.includes(e.id)&&(0,a.jsx)("span",{className:"text-blue-500",children:"✓"})]})},e.id))})]},e))]}):(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"任务标题 *"}),(0,a.jsx)("input",{type:"text",value:x.title,onChange:e=>u(s=>({...s,title:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"输入任务标题"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"任务描述"}),(0,a.jsx)("textarea",{value:x.description,onChange:e=>u(s=>({...s,description:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3,placeholder:"输入任务描述（可选）"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"预估时间（分钟）"}),(0,a.jsx)("input",{type:"number",value:x.estimatedMinutes,onChange:e=>u(s=>({...s,estimatedMinutes:parseInt(e.target.value)||15})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",min:"1"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"分类"}),(0,a.jsxs)("select",{value:x.category,onChange:e=>u(s=>({...s,category:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[y.map(e=>(0,a.jsx)("option",{value:e,children:e},e)),(0,a.jsx)("option",{value:"其他",children:"其他"})]})]})]})]}),v&&(0,a.jsxs)("div",{className:"mt-6 p-4 bg-orange-50 border border-orange-200 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,a.jsx)("input",{type:"checkbox",id:"urgent",checked:h,onChange:e=>g(e.target.checked),className:"rounded"}),(0,a.jsx)("label",{htmlFor:"urgent",className:"text-sm font-medium text-orange-700",children:"设为加急任务"})]}),h&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-orange-700 mb-2",children:"外包价（元）"}),(0,a.jsx)("input",{type:"number",value:p,onChange:e=>f(parseFloat(e.target.value)||0),className:"w-full px-3 py-2 border border-orange-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500",placeholder:"输入外包价格",min:"0",step:"0.5"}),(0,a.jsx)("p",{className:"text-xs text-orange-600 mt-1",children:"对方同意后，此金额将加入月度基金"})]})]})]}),(0,a.jsx)("div",{className:"p-6 border-t bg-gray-50",children:(0,a.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,a.jsx)(j,{variant:"outline",onClick:t,children:"取消"}),(0,a.jsx)(j,{variant:"primary",onClick:"templates"===d?()=>{m.forEach(e=>{let t=N.find(s=>s.id===e);if(t){let e={title:t.title,description:t.description,status:n.e.TODO,estimatedMinutes:t.estimatedMinutes,category:t.category,isUrgent:!!v&&h,urgentPrice:v&&h?p:void 0};v&&h?i.addUrgentRequest({taskId:"",requestedBy:s.members[0].id,estimatedMinutes:t.estimatedMinutes,price:p,message:"加急任务：".concat(t.title),status:"pending"}):i.assignTaskAutomatically(e)}}),t()}:()=>{if(!x.title.trim())return void alert("请输入任务标题");let e={title:x.title,description:x.description,status:n.e.TODO,estimatedMinutes:x.estimatedMinutes,category:x.category,isUrgent:!!v&&h,urgentPrice:v&&h?p:void 0};v&&h?i.addUrgentRequest({taskId:"",requestedBy:s.members[0].id,estimatedMinutes:x.estimatedMinutes,price:p,message:"加急任务：".concat(x.title),status:"pending"}):i.assignTaskAutomatically(e),t()},disabled:"templates"===d?0===m.length:!x.title.trim(),children:"templates"===d?"创建 ".concat(m.length," 个任务"):"创建任务"})]})})]})})}function w(e){let{family:s,tasks:t,dailyStats:l,onShare:i}=e,d=(0,r.useRef)(null),c=new Date().toISOString().split("T")[0],m=t.filter(e=>e.status===n.e.COMPLETED&&e.completedAt&&new Date(e.completedAt).toISOString().split("T")[0]===c),o=s.members.map(e=>{let s=(0,b.qL)(e.id,t);return{member:e,stats:s}}),h=o.reduce((e,s)=>e+s.stats.minutesWorked,0),g=o.reduce((e,s)=>e+s.stats.tasksCompleted,0),p=async()=>{if(d.current)try{let e="\uD83C\uDFE0 ".concat(s.name," 今日战绩\n\uD83D\uDCC5 ").concat(x(new Date),"\n⏱️ 总时长：").concat(u(h),"\n✅ 完成任务：").concat(g,"项\n\n").concat(o.map(e=>"".concat(e.member.name,"：").concat(e.stats.tasksCompleted,"项 ").concat(u(e.stats.minutesWorked))).join("\n"),"\n\n#家庭助手 #家务分工");await navigator.clipboard.writeText(e),alert("战绩已复制到剪贴板！")}catch(e){console.error("分享失败:",e),alert("分享功能暂不可用")}};return(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:[(0,a.jsxs)("div",{ref:d,className:"bg-gradient-to-br from-blue-500 to-purple-600 text-white p-6",children:[(0,a.jsxs)("div",{className:"text-center mb-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-2",children:"今日家务战绩"}),(0,a.jsx)("p",{className:"text-blue-100",children:x(new Date)})]}),(0,a.jsx)("div",{className:"bg-white bg-opacity-20 rounded-lg p-4 mb-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-3xl font-bold",children:u(h)}),(0,a.jsx)("div",{className:"text-sm text-blue-100",children:"总时长"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-3xl font-bold",children:g}),(0,a.jsx)("div",{className:"text-sm text-blue-100",children:"完成任务"})]})]})}),(0,a.jsx)("div",{className:"space-y-4",children:o.map((e,s)=>{let t=h>0?e.stats.minutesWorked/h*100:0;return(0,a.jsxs)("div",{className:"bg-white bg-opacity-20 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-white bg-opacity-30 rounded-full flex items-center justify-center text-lg font-bold",children:e.member.name.charAt(0)}),(0,a.jsx)("span",{className:"font-medium",children:e.member.name})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"font-bold",children:[e.stats.tasksCompleted,"项"]}),(0,a.jsx)("div",{className:"text-sm text-blue-100",children:u(e.stats.minutesWorked)})]})]}),(0,a.jsx)("div",{className:"w-full bg-white bg-opacity-20 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-white rounded-full h-2 transition-all duration-500",style:{width:"".concat(t,"%")}})}),(0,a.jsxs)("div",{className:"text-xs text-blue-100 mt-1 text-right",children:[t.toFixed(1),"%"]})]},e.member.id)})}),m.length>0&&(0,a.jsxs)("div",{className:"mt-6",children:[(0,a.jsx)("h3",{className:"font-medium mb-3",children:"今日完成任务："}),(0,a.jsxs)("div",{className:"space-y-2",children:[m.slice(0,5).map(e=>{let t=s.members.find(s=>s.id===e.assignedTo);return(0,a.jsx)("div",{className:"bg-white bg-opacity-20 rounded p-2 text-sm",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("span",{children:["✅ ",e.title]}),(0,a.jsxs)("span",{className:"text-blue-100",children:[null==t?void 0:t.name," • ",e.actualMinutes?u(e.actualMinutes):""]})]})},e.id)}),m.length>5&&(0,a.jsxs)("div",{className:"text-center text-blue-100 text-sm",children:["还有 ",m.length-5," 项任务..."]})]})]}),(0,a.jsx)("div",{className:"text-center mt-6 text-blue-100 text-sm",children:"\uD83C\uDFE0 家庭助手 • 让家务可见可停机可议价"})]}),(0,a.jsxs)("div",{className:"p-4 bg-gray-50",children:[(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsxs)(j,{variant:"outline",onClick:p,className:"flex-1",children:[(0,a.jsx)("span",{className:"mr-2",children:"\uD83D\uDCE4"}),"分享战绩"]}),i&&(0,a.jsxs)(j,{variant:"primary",onClick:i,className:"flex-1",children:[(0,a.jsx)("span",{className:"mr-2",children:"\uD83D\uDCCA"}),"查看详情"]})]}),(0,a.jsx)("div",{className:"text-center mt-3",children:h>0?(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["\uD83C\uDF89 今天辛苦了！",h>=60?"超棒的":"不错的","表现！"]}):(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"\uD83D\uDE0A 今天还没有完成任务，加油！"})})]})]})}var D=t(1607),k=t(877);function C(e){let{family:s,dailyStats:t}=e,l=(0,r.useRef)(null),i=(0,b.kR)(s.members,t),n={labels:["周日","周一","周二","周三","周四","周五","周六"],datasets:s.members.map((e,s)=>{let t=[{bg:"rgba(59, 130, 246, 0.8)",border:"rgb(59, 130, 246)"},{bg:"rgba(16, 185, 129, 0.8)",border:"rgb(16, 185, 129)"},{bg:"rgba(245, 158, 11, 0.8)",border:"rgb(245, 158, 11)"},{bg:"rgba(239, 68, 68, 0.8)",border:"rgb(239, 68, 68)"}],a=t[s%t.length],r=i.userStats[e.id],l=Array(7).fill(0);return r&&r.dailyBreakdown.forEach(e=>{l[new Date(e.date).getDay()]=e.minutesWorked}),{label:e.name,data:l,backgroundColor:a.bg,borderColor:a.border,borderWidth:1}})};return(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-gray-900",children:"本周统计"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[i.weekStart," 至 ",i.weekEnd]})]}),(0,a.jsx)("button",{onClick:()=>{if(l.current){let e=l.current.toBase64Image(),s=document.createElement("a");s.download="家庭助手-周统计-".concat(new Date().toISOString().split("T")[0],".png"),s.href=e,s.click()}},className:"px-3 py-1 text-sm bg-blue-100 text-blue-700 rounded hover:bg-blue-200 transition-colors",children:"\uD83D\uDCE5 导出图片"})]}),(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)(k.yP,{ref:l,data:n,options:{responsive:!0,plugins:{legend:{position:"top"},title:{display:!0,text:"本周工作时长对比（分钟）",font:{size:16,weight:"bold"}},tooltip:{callbacks:{label:function(e){let s=e.parsed.y;return"".concat(e.dataset.label,": ").concat(u(s))}}}},scales:{y:{beginAtZero:!0,ticks:{callback:function(e){return u(e)}},title:{display:!0,text:"工作时长"}},x:{title:{display:!0,text:"星期"}}}}})}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.members.map(e=>{let s=i.userStats[e.id],t=(null==s?void 0:s.minutesWorked)||0,r=(null==s?void 0:s.tasksCompleted)||0,l=t/7;return(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white text-sm font-bold",children:e.name.charAt(0)}),(0,a.jsx)("span",{className:"font-medium text-gray-900",children:e.name})]}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"本周总时长："}),(0,a.jsx)("span",{className:"font-medium",children:u(t)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"完成任务："}),(0,a.jsxs)("span",{className:"font-medium",children:[r,"项"]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"日均时长："}),(0,a.jsx)("span",{className:"font-medium",children:u(Math.round(l))})]})]})]},e.id)})}),(0,a.jsxs)("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[(0,a.jsx)("h4",{className:"font-medium text-blue-900 mb-2",children:"\uD83D\uDCCA 工作平衡度分析"}),(0,a.jsx)("div",{className:"text-sm text-blue-800",children:(()=>{let e=s.members.map(e=>{var s;return(null==(s=i.userStats[e.id])?void 0:s.minutesWorked)||0}),t=Math.max(...e),a=Math.min(...e),r=t>0?1-(t-a)/t:1;return r>=.9?"\uD83C\uDFAF 工作分配非常均衡！继续保持！":r>=.7?"\uD83D\uDC4D 工作分配比较均衡，略有差异。":r>=.5?"⚖️ 工作分配有一定差异，可以适当调整。":"⚠️ 工作分配差异较大，建议重新分配任务。"})()})]})]})}function E(e){let{family:s,tasks:t,dailyStats:l,onClose:i}=e,[n,d]=(0,r.useState)("daily");return(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[(0,a.jsxs)("div",{className:"p-6 border-b",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"家务战绩统计"}),(0,a.jsx)("button",{onClick:i,className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)("span",{className:"text-2xl",children:"\xd7"})})]}),(0,a.jsx)("div",{className:"mt-4 border-b",children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("button",{onClick:()=>d("daily"),className:"px-4 py-2 text-sm font-medium border-b-2 ".concat("daily"===n?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"),children:"今日战绩"}),(0,a.jsx)("button",{onClick:()=>d("weekly"),className:"px-4 py-2 text-sm font-medium border-b-2 ".concat("weekly"===n?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"),children:"周统计"})]})})]}),(0,a.jsx)("div",{className:"p-6 max-h-[70vh] overflow-y-auto",children:"daily"===n?(0,a.jsx)(w,{family:s,tasks:t,dailyStats:l}):(0,a.jsx)(C,{family:s,dailyStats:l})}),(0,a.jsx)("div",{className:"p-6 border-t bg-gray-50",children:(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsx)(j,{variant:"primary",onClick:i,children:"关闭"})})})]})})}function T(e){let{requests:s,family:t,onClose:i}=e,{actions:n}=(0,l.n)(),[d,c]=(0,r.useState)(null),m=s.filter(e=>"pending"===e.status);return 0===m.length?(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsx)("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-4xl mb-4",children:"✅"}),(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"暂无待处理请求"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:"当前没有需要议价的加急任务"}),(0,a.jsx)(j,{variant:"primary",onClick:i,children:"关闭"})]})})}):(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-hidden",children:[(0,a.jsxs)("div",{className:"p-6 border-b",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"加急任务议价"}),(0,a.jsx)("button",{onClick:i,className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)("span",{className:"text-2xl",children:"\xd7"})})]}),(0,a.jsxs)("p",{className:"text-gray-600 mt-2",children:["有 ",m.length," 个加急任务等待您的确认"]})]}),(0,a.jsx)("div",{className:"p-6 max-h-[60vh] overflow-y-auto",children:(0,a.jsx)("div",{className:"space-y-4",children:m.map(e=>{let r=t.members.find(s=>s.id===e.requestedBy);return(0,a.jsxs)("div",{className:"p-4 border-2 rounded-lg transition-all ".concat(d===e.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),children:[(0,a.jsx)("div",{className:"flex items-start justify-between",children:(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)("span",{className:"text-lg",children:"\uD83D\uDEA8"}),(0,a.jsx)("h3",{className:"font-medium text-gray-900",children:e.message})]}),(0,a.jsxs)("div",{className:"space-y-2 text-sm text-gray-600",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("span",{children:["申请人：",null==r?void 0:r.name]}),(0,a.jsxs)("span",{children:["时间：",o(new Date(e.createdAt))]})]}),e.estimatedMinutes&&(0,a.jsxs)("div",{children:["预估时长：",u(e.estimatedMinutes)]}),e.price&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{children:"外包价："}),(0,a.jsxs)("span",{className:"font-medium text-green-600",children:["\xa5",e.price]})]})]}),(0,a.jsx)("div",{className:"mt-3 p-3 bg-orange-50 border border-orange-200 rounded text-sm text-orange-700",children:"\uD83D\uDCA1 同意后，此金额将加入月度基金，可用于双人奶茶/电影等奖励"})]})}),(0,a.jsxs)("div",{className:"mt-4 flex gap-3",children:[(0,a.jsx)(j,{variant:"outline",size:"sm",onClick:()=>{var s;return s=e.id,void n.updateUrgentRequest(s,"rejected")},className:"flex-1",children:"拒绝"}),(0,a.jsxs)(j,{variant:"primary",size:"sm",onClick:()=>(e=>{let a=s.find(s=>s.id===e);a&&(n.updateUrgentRequest(e,"approved"),a.price&&n.updateFamily({monthlyFund:t.monthlyFund+a.price}),n.addTask({title:a.message||"加急任务",description:"议价通过的加急任务，外包价：\xa5".concat(a.price),status:"todo",estimatedMinutes:a.estimatedMinutes||30,category:"加急",isUrgent:!0,urgentPrice:a.price,assignedTo:a.requestedBy}))})(e.id),className:"flex-1",children:["同意（\xa5",e.price,"）"]})]})]},e.id)})})}),(0,a.jsx)("div",{className:"p-6 border-t bg-gray-50",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:["当前月度基金：\xa5",t.monthlyFund]}),(0,a.jsx)(j,{variant:"outline",onClick:i,children:"稍后处理"})]})})]})})}function S(e){let{availableTasks:s,family:t,currentUserId:i,onClose:d}=e,{actions:c}=(0,l.n)(),[m,x]=(0,r.useState)([]),h=t.members.find(e=>e.id===i),g=s.filter(e=>e.status===n.e.TODO&&e.assignedTo!==i);return 0===g.length?(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsx)("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-4xl mb-4",children:"\uD83D\uDE0A"}),(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"暂无可抢单任务"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:"当前没有可以抢单的任务，或者所有任务都已分配给您"}),(0,a.jsx)(j,{variant:"primary",onClick:d,children:"关闭"})]})})}):(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-hidden",children:[(0,a.jsx)("div",{className:"p-6 border-b",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"任务抢单"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:[null==h?void 0:h.name,"，选择您想要承接的任务"]})]}),(0,a.jsx)("button",{onClick:d,className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)("span",{className:"text-2xl",children:"\xd7"})})]})}),(0,a.jsx)("div",{className:"p-6 bg-blue-50 border-b",children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"text-2xl",children:"\uD83D\uDCAA"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-blue-900 mb-1",children:"抢单规则"}),(0,a.jsxs)("ul",{className:"text-sm text-blue-800 space-y-1",children:[(0,a.jsx)("li",{children:"• 可以抢取其他成员的待办任务"}),(0,a.jsx)("li",{children:"• 抢单后任务将重新分配给您"}),(0,a.jsx)("li",{children:"• 建议根据个人时间和能力合理抢单"})]})]})]})}),(0,a.jsx)("div",{className:"p-6 max-h-[50vh] overflow-y-auto",children:(0,a.jsx)("div",{className:"space-y-3",children:g.map(e=>{let s=t.members.find(s=>s.id===e.assignedTo),r=m.includes(e.id);return(0,a.jsx)("div",{onClick:()=>{var s;return s=e.id,void x(e=>e.includes(s)?e.filter(e=>e!==s):[...e,s])},className:"p-4 border-2 rounded-lg cursor-pointer transition-all ".concat(r?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),children:(0,a.jsx)("div",{className:"flex items-start justify-between",children:(0,a.jsxs)("div",{className:"flex items-start gap-3 flex-1",children:[(0,a.jsx)("div",{className:"mt-1",children:r?(0,a.jsx)("span",{className:"text-blue-500 text-lg",children:"✓"}):(0,a.jsx)("span",{className:"text-gray-300 text-lg",children:"○"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900",children:e.title}),e.isUrgent&&(0,a.jsx)("span",{className:"px-2 py-1 text-xs bg-red-100 text-red-700 rounded-full",children:"加急"})]}),e.description&&(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:e.description}),(0,a.jsxs)("div",{className:"flex gap-4 text-sm text-gray-500",children:[(0,a.jsxs)("span",{children:["分类：",e.category]}),e.estimatedMinutes&&(0,a.jsxs)("span",{children:["预估：",u(e.estimatedMinutes)]}),(0,a.jsxs)("span",{children:["创建：",o(new Date(e.createdAt))]})]}),s&&(0,a.jsxs)("div",{className:"mt-2 text-sm text-orange-600",children:["当前分配给：",s.name]})]})]})})},e.id)})})}),m.length>0&&(0,a.jsx)("div",{className:"p-4 bg-green-50 border-t border-b",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"text-sm text-green-800",children:["已选择 ",m.length," 个任务"]}),(0,a.jsxs)("div",{className:"text-sm font-medium text-green-900",children:["预估总时长：",u(m.reduce((e,s)=>{let t=g.find(e=>e.id===s);return e+((null==t?void 0:t.estimatedMinutes)||0)},0))]})]})}),(0,a.jsx)("div",{className:"p-6 border-t bg-gray-50",children:(0,a.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,a.jsx)(j,{variant:"outline",onClick:d,children:"取消"}),(0,a.jsxs)(j,{variant:"primary",onClick:()=>{if(0===m.length)return void alert("请选择要抢单的任务");m.forEach(e=>{c.updateTask(e,{assignedTo:i})}),alert("成功抢单 ".concat(m.length," 个任务！")),d()},disabled:0===m.length,children:["抢单 (",m.length,")"]})]})})]})})}function M(){let[e,s]=(0,r.useState)(null),[t,l]=(0,r.useState)(!1),[i,n]=(0,r.useState)(!1),[d,c]=(0,r.useState)(!1);(0,r.useEffect)(()=>{n(/iPad|iPhone|iPod/.test(navigator.userAgent)),c(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone||document.referrer.includes("android-app://"));let e=e=>{e.preventDefault(),s(e),setTimeout(()=>{l(!0)},3e3)},t=()=>{console.log("[PWA] App was installed"),l(!1),s(null)};return window.addEventListener("beforeinstallprompt",e),window.addEventListener("appinstalled",t),()=>{window.removeEventListener("beforeinstallprompt",e),window.removeEventListener("appinstalled",t)}},[]);let m=async()=>{if(e)try{await e.prompt();let{outcome:t}=await e.userChoice;console.log("[PWA] User response to install prompt: ".concat(t)),s(null),l(!1)}catch(e){console.error("[PWA] Install prompt failed:",e)}},o=()=>{l(!1),localStorage.setItem("pwa-install-dismissed",Date.now().toString())};return((0,r.useEffect)(()=>{let e=localStorage.getItem("pwa-install-dismissed");if(e){let s=parseInt(e);if((Date.now()-s)/36e5<24)return void l(!1)}},[]),d)?null:i&&t?(0,a.jsx)("div",{className:"fixed bottom-4 left-4 right-4 bg-blue-600 text-white p-4 rounded-lg shadow-lg z-50",children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"text-2xl",children:"\uD83D\uDCF1"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"font-bold mb-2",children:"安装家庭助手到主屏幕"}),(0,a.jsxs)("div",{className:"text-sm space-y-1",children:[(0,a.jsx)("p",{children:"1. 点击浏览器底部的分享按钮 \uD83D\uDCE4"}),(0,a.jsx)("p",{children:'2. 选择"添加到主屏幕"'}),(0,a.jsx)("p",{children:'3. 点击"添加"完成安装'})]})]}),(0,a.jsx)("button",{onClick:o,className:"text-white hover:text-gray-200",children:"✕"})]})}):e&&t?(0,a.jsx)("div",{className:"fixed bottom-4 left-4 right-4 bg-gradient-to-r from-blue-600 to-purple-600 text-white p-4 rounded-lg shadow-lg z-50",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"text-2xl",children:"\uD83C\uDFE0"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-bold",children:"安装家庭助手"}),(0,a.jsx)("p",{className:"text-sm text-blue-100",children:"安装到设备，获得更好的使用体验"})]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(j,{variant:"outline",size:"sm",onClick:o,className:"text-white border-white hover:bg-white hover:text-blue-600",children:"稍后"}),(0,a.jsx)(j,{variant:"primary",size:"sm",onClick:m,className:"bg-white text-blue-600 hover:bg-gray-100",children:"安装"})]})]})}):null}function O(){return(0,r.useEffect)(()=>{let e=()=>{let e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh","".concat(e,"px"))};return e(),window.addEventListener("resize",e),window.addEventListener("orientationchange",e),()=>{window.removeEventListener("resize",e),window.removeEventListener("orientationchange",e)}},[]),null}function A(){return(0,r.useEffect)(()=>{let e=()=>{window.innerHeight<.75*window.screen.height?document.body.classList.add("keyboard-open"):document.body.classList.remove("keyboard-open")};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),null}function P(){return(0,r.useEffect)(()=>{if("performance"in window){let e=new PerformanceObserver(e=>{for(let s of e.getEntries())"navigation"===s.entryType&&console.log("[Performance] Page load time:",s.duration),"paint"===s.entryType&&console.log("[Performance] ".concat(s.name,":"),s.startTime)});return e.observe({entryTypes:["navigation","paint"]}),()=>e.disconnect()}},[]),null}function R(){let[e,s]=(0,r.useState)(!0),[t,l]=(0,r.useState)("");return((0,r.useEffect)(()=>{let e=()=>{s(navigator.onLine)},t=()=>{let e=navigator.connection||navigator.mozConnection||navigator.webkitConnection;e&&l(e.effectiveType||e.type||"unknown")};e(),t(),window.addEventListener("online",e),window.addEventListener("offline",e);let a=navigator.connection;return a&&a.addEventListener("change",t),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",e),a&&a.removeEventListener("change",t)}},[]),e)?"slow-2g"===t||"2g"===t?(0,a.jsx)("div",{className:"fixed top-0 left-0 right-0 bg-orange-500 text-white text-center py-2 text-sm z-50",children:"\uD83D\uDC0C 网络连接较慢，部分功能可能受影响"}):null:(0,a.jsx)("div",{className:"fixed top-0 left-0 right-0 bg-red-500 text-white text-center py-2 text-sm z-50",children:"\uD83D\uDCE1 网络连接已断开，正在离线模式下运行"})}D.t1.register(D.PP,D.kc,D.E8,D.hE,D.m_,D.s$);var L=t(6747);function I(e){let{onRoomJoined:s}=e,[t]=(0,r.useState)(()=>L.d.getInstance()),[l,i]=(0,r.useState)(null),[n,d]=(0,r.useState)(null),[c,m]=(0,r.useState)([]),[o,x]=(0,r.useState)(!1),[u,h]=(0,r.useState)(!1),[g,b]=(0,r.useState)(""),[p,j]=(0,r.useState)(""),[f,v]=(0,r.useState)(""),[N,y]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let e=t.getCurrentRoomId();e&&(i(e),w(e))},[t]);let w=e=>{d(t.getRoomInfo(e)),m(t.getRoomMembers())};return l&&n?(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900",children:n.name}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["房间ID: ",l]})]}),(0,a.jsx)("button",{onClick:()=>{let e=t.getRoomShareLink();navigator.clipboard.writeText(e).then(()=>{alert("分享链接已复制到剪贴板！"),y(!1)}).catch(()=>{y(!0)})},className:"px-3 py-1.5 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 transition-colors",children:"分享房间"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[(0,a.jsxs)("span",{children:["\uD83D\uDC65 ",c.length," 位成员"]}),(0,a.jsxs)("span",{children:["\uD83D\uDD52 创建于 ",new Date(n.createdAt).toLocaleString("zh-CN",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})]})]}),c.length>0&&(0,a.jsx)("div",{className:"mt-3 flex flex-wrap gap-2",children:c.map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-1 px-2 py-1 bg-gray-100 rounded-full text-sm",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(e.isOnline?"bg-green-500":"bg-gray-400")}),(0,a.jsx)("span",{children:e.name})]},e.id))}),N&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"分享房间"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"复制下面的链接分享给其他家庭成员："}),(0,a.jsx)("div",{className:"bg-gray-100 p-3 rounded-lg mb-4 break-all text-sm",children:t.getRoomShareLink()}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(t.getRoomShareLink()),alert("已复制到剪贴板！"),y(!1)},className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"复制链接"}),(0,a.jsx)("button",{onClick:()=>y(!1),className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors",children:"关闭"})]})]})})]}):(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-4",children:[(0,a.jsxs)("div",{className:"text-center mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"欢迎使用家庭助手"}),(0,a.jsx)("p",{className:"text-gray-600",children:"创建新的家庭房间或加入现有房间开始协作"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,a.jsx)("button",{onClick:()=>x(!0),className:"p-4 border-2 border-dashed border-blue-300 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-colors",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl mb-2",children:"\uD83C\uDFE0"}),(0,a.jsx)("h3",{className:"font-medium text-gray-900",children:"创建新房间"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"建立一个新的家庭协作空间"})]})}),(0,a.jsx)("button",{onClick:()=>h(!0),className:"p-4 border-2 border-dashed border-green-300 rounded-lg hover:border-green-500 hover:bg-green-50 transition-colors",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl mb-2",children:"\uD83D\uDEAA"}),(0,a.jsx)("h3",{className:"font-medium text-gray-900",children:"加入房间"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"使用房间ID加入现有家庭"})]})})]}),o&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"创建新房间"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"房间名称"}),(0,a.jsx)("input",{type:"text",value:g,onChange:e=>b(e.target.value),placeholder:"例如：我们的家",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"您的昵称"}),(0,a.jsx)("input",{type:"text",value:f,onChange:e=>v(e.target.value),placeholder:"例如：小明",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),(0,a.jsxs)("div",{className:"flex gap-2 mt-6",children:[(0,a.jsx)("button",{onClick:()=>{if(!g.trim()||!f.trim())return;let e=t.createRoom(g.trim());t.addMemberToRoom(f.trim()),i(e),w(e),x(!1),b(""),v(""),s(e)},disabled:!g.trim()||!f.trim(),className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"创建房间"}),(0,a.jsx)("button",{onClick:()=>{x(!1),b(""),v("")},className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors",children:"取消"})]})]})}),u&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"加入房间"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"房间ID"}),(0,a.jsx)("input",{type:"text",value:p,onChange:e=>j(e.target.value.toUpperCase()),placeholder:"例如：ABC12345",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"您的昵称"}),(0,a.jsx)("input",{type:"text",value:f,onChange:e=>v(e.target.value),placeholder:"例如：小红",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),(0,a.jsxs)("div",{className:"flex gap-2 mt-6",children:[(0,a.jsx)("button",{onClick:()=>{p.trim()&&f.trim()&&(t.joinRoom(p.trim().toUpperCase())?(t.addMemberToRoom(f.trim()),i(p.trim().toUpperCase()),w(p.trim().toUpperCase()),h(!1),j(""),v(""),s(p.trim().toUpperCase())):alert("房间不存在或已过期"))},disabled:!p.trim()||!f.trim(),className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"加入房间"}),(0,a.jsx)("button",{onClick:()=>{h(!1),j(""),v("")},className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors",children:"取消"})]})]})})]})}function z(){let{state:e,actions:s}=(0,l.n)(),{data:t,isLoading:i,isInRoom:n}=e,[d,c]=(0,r.useState)(!1),[m,o]=(0,r.useState)(!1),[x,u]=(0,r.useState)(!1),[h,g]=(0,r.useState)(!1),[b,j]=(0,r.useState)(!1);return((0,r.useEffect)(()=>{if(!t)return;let e=()=>{let e=new Date,[s,a]=t.family.workEndTime.split(":").map(Number),r=new Date;r.setHours(s,a,0,0),e>=r&&!x&&u(!0)},s=setInterval(e,6e4);return e(),()=>clearInterval(s)},[t,x]),(0,r.useEffect)(()=>{t&&t.urgentRequests.filter(e=>"pending"===e.status).length>0&&!h&&setTimeout(()=>{g(!0)},1e3)},[t,h]),i)?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"加载中..."})]})}):t?(0,a.jsxs)("div",{className:"min-h-screen-safe bg-gray-50",children:[(0,a.jsx)(O,{}),(0,a.jsx)(A,{}),(0,a.jsx)(P,{}),(0,a.jsx)(R,{}),!n&&(0,a.jsx)("div",{className:"container mx-auto px-4 py-6",children:(0,a.jsx)(I,{onRoomJoined:e=>{window.location.reload()}})}),n&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f,{family:t.family,onShowStats:()=>o(!0),onShowTaskCreator:()=>c(!0),onShowTaskGrab:()=>j(!0)}),(0,a.jsx)("main",{className:"container mx-auto px-4 py-6",children:(0,a.jsx)(p,{tasks:t.tasks,family:t.family})})]}),d&&(0,a.jsx)(y,{family:t.family,onClose:()=>c(!1)}),m&&(0,a.jsx)(E,{family:t.family,tasks:t.tasks,dailyStats:t.dailyStats,onClose:()=>o(!1)}),x&&(0,a.jsx)(v,{workEndTime:t.family.workEndTime,onClose:()=>u(!1),onContinue:()=>{u(!1),c(!0)}}),h&&(0,a.jsx)(T,{requests:t.urgentRequests,family:t.family,onClose:()=>g(!1)}),b&&(0,a.jsx)(S,{availableTasks:t.tasks,family:t.family,currentUserId:t.family.members[0].id,onClose:()=>j(!1)}),(0,a.jsx)(M,{})]}):(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)("p",{className:"text-red-600",children:"数据加载失败，请刷新页面重试"})})})}}},e=>{e.O(0,[647,303,273,441,255,358],()=>e(e.s=247)),_N_E=e.O()}]);